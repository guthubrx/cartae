# Restic Backup Crontab Configuration
# Session 81e - Backup & Disaster Recovery
# Session 86 - Updated to 6-hour backup frequency
# This file is mounted at /etc/crontabs/root in the container

# Full backup every 6 hours (00:00, 06:00, 12:00, 18:00 UTC)
0 */6 * * * /scripts/backup.sh all >> /var/log/restic/cron.log 2>&1

# Weekly integrity check on Sundays at 03:00 UTC
0 3 * * 0 restic check --read-data-subset=10% >> /var/log/restic/integrity-check.log 2>&1

# Monthly repository prune on 1st of month at 04:00 UTC
0 4 1 * * restic prune --max-unused 10% >> /var/log/restic/prune.log 2>&1

# Log rotation: Keep last 30 days of logs
0 5 * * * find /var/log/restic -name "*.log" -mtime +30 -delete

# Health check: Verify last snapshot exists (every 6 hours)
0 */6 * * * restic snapshots --last || echo "WARNING: No recent snapshot found!" >> /var/log/restic/health-check.log 2>&1
