# Restic Backup Configuration
# Session 81e - Backup & Disaster Recovery
# Session 86 - Offsite Backup S3/B2 + 6h frequency
# Copy to .env and fill in actual values

# ========================================
# Restic Repository Configuration
# ========================================

# LOCAL BACKUP (Development/Testing)
# RESTIC_REPOSITORY=/backups/repo

# AWS S3 (Production recommended - $2.30/mois per 100GB)
RESTIC_REPOSITORY=s3:s3.amazonaws.com/cartae-backups-prod

# Backblaze B2 (Alternative économique - $0.50/mois per 100GB, 4× cheaper)
# RESTIC_REPOSITORY=s3:s3.us-west-004.backblazeb2.com/cartae-backups-prod
# RESTIC_S3_ENDPOINT=https://s3.us-west-004.backblazeb2.com

# Google Cloud Storage
# RESTIC_REPOSITORY=gs:cartae-backups-prod:/

# Restic encryption password (REQUIRED)
# Generate with: openssl rand -base64 32
# ⚠️ CRITICAL: Backup this password! Lost password = lost backups
RESTIC_PASSWORD=YOUR_STRONG_PASSWORD_HERE

# ========================================
# S3 Backend Configuration (Production)
# ========================================

# AWS/B2 credentials
AWS_ACCESS_KEY_ID=YOUR_AWS_ACCESS_KEY_OR_B2_KEY_ID
AWS_SECRET_ACCESS_KEY=YOUR_AWS_SECRET_KEY_OR_B2_APPLICATION_KEY

# AWS region (if using AWS S3)
AWS_DEFAULT_REGION=eu-west-1

# ========================================
# Backup Schedule & Retention
# ========================================

# Cron schedule (Session 86: every 6 hours)
# 00:00, 06:00, 12:00, 18:00 UTC
BACKUP_SCHEDULE=0 */6 * * *

# Retention policy
BACKUP_RETENTION_DAILY=7     # Keep 7 daily backups
BACKUP_RETENTION_WEEKLY=4    # Keep 4 weekly backups
BACKUP_RETENTION_MONTHLY=12  # Keep 12 monthly backups

# ========================================
# PostgreSQL Configuration
# ========================================

POSTGRES_HOST=cartae-database
POSTGRES_PORT=5432
POSTGRES_DB=cartae
POSTGRES_USER=cartae
POSTGRES_PASSWORD=YOUR_POSTGRES_PASSWORD

# ========================================
# Redis Configuration
# ========================================

REDIS_HOST=cartae-redis
REDIS_PORT=6379

# ========================================
# Monitoring Integration
# ========================================

# Prometheus Pushgateway (optional)
# PROMETHEUS_PUSHGATEWAY=http://prometheus-pushgateway:9091

# ========================================
# Backup Storage Path
# ========================================

# Local filesystem path for backup repository
# This directory will be mounted into the container
RESTIC_BACKUP_PATH=./backups

# ========================================
# Disaster Recovery Targets
# ========================================

# Recovery Time Objective (RTO) - Target: 4 hours
# Recovery Point Objective (RPO) - Target: 24 hours

# ========================================
# Testing & Validation
# ========================================

# Enable automated backup validation (recommended)
BACKUP_ENABLE_VALIDATION=true

# Backup verification frequency (in days)
BACKUP_VERIFICATION_INTERVAL=7
